# for python3


from socketserver import TCPServer,BaseRequestHandler

""" 
 전부 문자열 ㄸㄸㄸㄸ
['0001', # 0  데이터로거 ID
 '01MN', # 1  자료 타입 
 '20231223170800',  # 2  날짜
 '-3.8', # 3  기온
 '-3.7', # 4
 '-3.8', # 5
 '52.1', # 6  습도?
 '52.7', # 7
 '51.7', # 8
 '1024.8', #9   기압
 '1024.8', #10
 '1024.8', #11
 '0.0', 
 '0.0',
 '0.2',   # 풍속인듯 !
 '0.0',
 '0.0',
 '92.9',  # ? 
 '84.6',  #18 풍향 360
 '15.0'] #19 로거 전압 
"""
def parse_KWEATHER(_bytes):
    if _bytes[0] == 0x02 and _bytes[-1] == 0x03:
        print("ok")
        _list=_bytes[1:-1].decode().split(',')
        return _list
    return ""
    

class HandleClass(BaseRequestHandler):
    #def __init__(
    def setup(self):
        pass
    def handle(self):
        sock=self.request 
        data=sock.recv(1024)
        print("happend?", self.client_address,type(self.request))
        #print(" ===>", data)
        
    def finish(self):
        print("finished!")

#server= TCPServer(("192.168.1.5",2000),HandleClass)
#server= TCPServer(("0.0.0.0",2000),HandleClass)
#server.serve_forever()


_b1=b'\x020001,01MN,20231223170800,-3.8,-3.7,-3.8,52.1,52.7,51.7,1024.8,1024.8,1024.8,0.0,0.0,0.2,0.0,0.0,92.9,84.6,15.0\x03'
_b2=b'\x02-0.5,-15.6,0.0\x03\r\n'

c=parse_KWEATHER(_b1)
"""
b'\x020001,01MN,20231223170800,-3.8,-3.7,-3.8,52.1,52.7,51.7,1024.8,1024.8,1024.8,0.0,0.0,0.2,0.0,0.0,92.9,84.6,15.0\x03'
b'\x02-0.5,-15.6,0.0\x03\r\n'
b'\x020001,01MN,20231223170900,-3.8,-3.8,-3.8,53.6,53.9,53.3,1024.8,1024.8,1024.8,0.0,0.0,0.2,0.0,0.0,76.7,70.5,15.0\x03'
b'\x02-0.5,-15.6,0.0\x03\r\n'
b'\x020001,01MN,20231223171000,-3.9,-3.8,-3.9,53.6,54.0,53.3,1024.8,1024.9,1024.8,0.0,0.0,0.2,0.0,0.0,90.6,98.7,15.0\x03'
b'\x02-0.5,-15.6,0.0\x03\r\n'
b'\x020001,01MN,20231223171200,-4.0,-3.9,-4.0,52.4,52.5,52.4,1024.9,1024.9,1024.9,0.0,0.0,0.2,0.0,0.0,105.3,107.2,15.0\x03'
b'\x02-0.5,-15.6,0.0\x03\r\n'
b'\x020001,01MN,20231223171300,-4.0,-4.0,-4.0,52.3,52.4,52.3,1024.9,1025.0,1024.9,0.0,0.0,0.2,0.0,0.0,108.6,135.4,15.0\x03'
b'\x02-0.5,-15.6,0.0\x03\r\n'

"""
